(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[818],{18655:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(95155),n=s(35695),l=s(12115),i=s(34293),r=s(81115),c=s(89852),d=s(97168),o=s(95784),u=s(41559),m=s(71919),x=s(76037),f=s(84995),h=s(36639);function g(){let[e,t]=(0,l.useState)({originatingOffice:"",subject:"",dateOfDocument:"",fsisReferenceNumber:"",awdReceivedDate:"",forwardedBy:"",forwardedTo:"",remarks:"",status:"Open",workingDays:"3"}),s=(0,n.useParams)(),g=(0,n.useRouter)(),[p,j]=(0,l.useState)(null),[b,v]=(0,l.useState)(null),[w,N]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=async e=>{try{let s=(0,r.KR)(i.OO,"documents/".concat(e)),a=await (0,r.Jt)(s);if(a.exists()){let s=a.val();t({originatingOffice:s.originatingOffice||"",subject:s.subject||"",dateOfDocument:s.dateOfDocument||"",fsisReferenceNumber:s.fsisReferenceNumber||"",awdReceivedDate:s.awdReceivedDate||"",forwardedBy:s.forwardedBy||"",forwardedTo:s.forwardedTo||"",remarks:s.remarks||"",status:s.status||"Open",workingDays:s.workingDays||"3"}),v(s.awdReferenceNumber||e)}else{let s=(0,r.KR)(i.OO,"tracking/".concat(e)),a=await (0,r.Jt)(s);if(a.exists()){let s=a.val();t({originatingOffice:s.originatingOffice||"",subject:s.subject||"",dateOfDocument:s.dateOfDocument||"",fsisReferenceNumber:s.fsisReferenceNumber||"",awdReceivedDate:s.awdReceivedDate||"",forwardedBy:s.forwardedBy||"",forwardedTo:s.forwardedTo||"",remarks:s.remarks||"",status:s.status||"Open",workingDays:s.workingDays||"3"}),v(s.awdReferenceNumber||e)}else console.warn("Document not found in either location."),alert("Document not found. Redirecting back to sent documents."),g.push("/admin/Documents/sentdocs")}N(!1)}catch(e){console.error("Error fetching document data:",e),alert("Error loading document data. Please try again."),N(!1)}},a=localStorage.getItem("selectedAwdRefNum"),n=s.awdrefnu,l=null;l=new URLSearchParams(window.location.search).get("awdrefnu");let c=n||l;c?(v(c),e(c)):a&&(v(a),e(a))},[s,g]),(0,l.useEffect)(()=>{let e=i.j2.onAuthStateChanged(async e=>{e?(await D(e.uid),b?console.log("Fetching data for:",b):(console.warn("No AWD reference number found"),N(!1))):g.push("/login")});return()=>e()},[b,g]);let D=async e=>{try{let t=(0,r.KR)(i.OO,"accounts/".concat(e)),s=await (0,r.Jt)(t);if(s.exists()){let e=s.val();j({name:e.name,role:e.role||"Admin"})}else console.warn("User data not found in 'accounts'.")}catch(e){console.error("Error fetching admin info:",e)}},y=s=>{t({...e,[s.target.name]:s.target.value})},O=async t=>{if(t.preventDefault(),!p||!b){alert("User not authenticated or document ID missing.");return}let s=e.originatingOffice.toUpperCase(),a=e.subject.toUpperCase();try{let t={...e,originatingOffice:s,subject:a,awdReferenceNumber:b};await (0,r.yo)((0,r.KR)(i.OO,"documents/".concat(b)),t),await (0,r.yo)((0,r.KR)(i.OO,"tracking/".concat(b)),t),alert("Document successfully updated!"),g.push("/admin/Documents/sentdocs")}catch(e){console.error("Error updating document:",e),alert("Failed to update document. Please try again.")}};return(0,a.jsx)(h.A,{allowedDivisions:["admin"],children:(0,a.jsx)(m.GB,{children:(0,a.jsxs)("div",{className:"flex h-screen",children:[(0,a.jsx)(u.G,{}),(0,a.jsxs)(m.sF,{className:"flex flex-1 flex-col",children:[(0,a.jsxs)("header",{className:"flex h-16 items-center gap-2 border-b px-4 bg-white",children:[(0,a.jsx)(m.x2,{className:"-ml-1"}),(0,a.jsx)(x.w,{orientation:"vertical",className:"mr-2 h-4"}),(0,a.jsx)(f.Qp,{children:(0,a.jsxs)(f.AB,{children:[(0,a.jsx)(f.J5,{className:"hidden md:block",children:(0,a.jsx)(f.tJ,{children:"Documents"})}),(0,a.jsx)(f.tH,{className:"hidden md:block"}),(0,a.jsx)(f.J5,{children:(0,a.jsx)(f.tJ,{children:"Edit Document"})})]})})]}),w?(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)("p",{className:"text-xl",children:"Loading document data..."})}):(0,a.jsxs)("form",{className:"p-10",onSubmit:O,children:[(0,a.jsx)("h1",{className:"text-6xl font-bold mb-6",children:"Edit Document"}),b&&(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("p",{className:"text-lg font-semibold",children:["AWD Reference Number: ",b]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xl font-semibold pb-2",children:"Originating Office"}),(0,a.jsx)(c.p,{name:"originatingOffice",type:"text",className:"w-full h-[50px]",value:e.originatingOffice,onChange:y,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xl font-semibold pb-2",children:"Subject"}),(0,a.jsx)(c.p,{name:"subject",type:"text",className:"w-full h-[50px]",value:e.subject,onChange:y,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xl font-semibold pb-2",children:"Date of Document"}),(0,a.jsx)(c.p,{name:"dateOfDocument",type:"date",className:"w-full h-[50px]",value:e.dateOfDocument,onChange:y,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xl font-semibold pb-2",children:"FSIS Reference Number"}),(0,a.jsx)(c.p,{name:"fsisReferenceNumber",type:"text",className:"w-full h-[50px]",value:e.fsisReferenceNumber,onChange:y})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xl font-semibold pb-2",children:"AWD Received Date"}),(0,a.jsx)(c.p,{name:"awdReceivedDate",type:"date",className:"w-full h-[50px]",value:e.awdReceivedDate,onChange:y,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-lg font-semibold pb-2",children:"Forwarded To"}),(0,a.jsxs)(o.l6,{value:e.forwardedTo,onValueChange:s=>t({...e,forwardedTo:s}),required:!0,children:[(0,a.jsx)(o.bq,{className:"w-full h-12",children:(0,a.jsx)(o.yv,{placeholder:"Select division"})}),(0,a.jsx)(o.gC,{children:(0,a.jsxs)(o.s3,{children:[(0,a.jsx)(o.eb,{value:"CATCID Admin",children:"CATCID Admin"}),(0,a.jsx)(o.eb,{value:"GACID Admin",children:"GACID Admin"}),(0,a.jsx)(o.eb,{value:"MOOCSU Admin",children:"MOOCSU Admin"}),(0,a.jsx)(o.eb,{value:"EARD Admin",children:"EARD Admin"}),(0,a.jsx)(o.eb,{value:"Secretary",children:"Secretary"})]})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xl font-semibold pb-2",children:"Remarks"}),(0,a.jsx)(c.p,{name:"remarks",type:"text",className:"w-full h-[50px]",value:e.remarks,onChange:y})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xl font-semibold pb-2",children:"Working Days"}),(0,a.jsxs)(o.l6,{value:e.workingDays,onValueChange:s=>t({...e,workingDays:s}),children:[(0,a.jsx)(o.bq,{className:"w-full h-[50px]",children:(0,a.jsx)(o.yv,{placeholder:"Select working days"})}),(0,a.jsx)(o.gC,{children:(0,a.jsxs)(o.s3,{children:[(0,a.jsx)(o.eb,{value:"3",children:"3 Days"}),(0,a.jsx)(o.eb,{value:"7",children:"7 Days"}),(0,a.jsx)(o.eb,{value:"20",children:"20 Days"})]})})]})]})]}),(0,a.jsxs)("div",{className:"mt-10 flex gap-4",children:[(0,a.jsx)(d.$,{type:"submit",className:"w-40 h-20 text-[20px] font-bold",children:"Update Document"}),(0,a.jsx)(d.$,{type:"button",variant:"outline",className:"w-40 h-20 text-[20px] font-bold",onClick:()=>g.push("/admin/Documents/sentdocs"),children:"Cancel"})]})]})]})]})})})}},41559:(e,t,s)=>{"use strict";s.d(t,{G:()=>m});var a=s(95155);s(12115);var n=s(13052),l=s(50095),i=s(6874),r=s.n(i),c=s(65204),d=s(71919),o=s(66766);let u={navMain:[{title:"Home",items:[{title:"Dashboard",url:"/admin/dashboard"},{title:"Division",url:"/admin/division"},{title:"Mandays",url:"/admin/mandays"}]},{title:"Accounts",items:[{title:"Manage Accounts",url:"/admin/Accounts/manageacc"},{title:"Create Accounts",url:"/admin/Accounts/createacc"}]},{title:"Incoming Documents",items:[{title:"Assign Track",url:"/admin/Documents/assigntrack"},{title:"Ongoing Documents",url:"/admin/Documents/ongoingdocs"},{title:"Sent Documents",url:"/admin/Documents/sentdocs"},{title:"Pending Documents",url:"/admin/outgoingdocuments/pendingdocs"}]},{title:"Outgoing Documents",items:[{title:"Closed Documents",url:"/admin/outgoingdocuments/closeddocs"},{title:"Returned Documents",url:"/admin/outgoingdocuments/returneddocs"}]}]};function m(e){let{...t}=e;return(0,a.jsxs)(d.Bx,{...t,children:[(0,a.jsxs)(d.Gh,{className:"flex items-center pt-2 font-bold justify-center text-2xl gap-2",children:[(0,a.jsx)(o.default,{src:"/images/awdlogo.png",alt:"Airworthiness Logo",width:80,height:80,className:"w-20 h-20"}),"AIRWORTHINESS"]}),(0,a.jsx)(d.Yv,{className:"gap-0",children:u.navMain.map(e=>(0,a.jsx)(c.Nt,{title:e.title,defaultOpen:!0,className:"group/collapsible",children:(0,a.jsxs)(d.Cn,{children:[(0,a.jsx)(d.jj,{asChild:!0,className:"group/label text-sm text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",children:(0,a.jsxs)(c.R6,{children:[e.title," ",(0,a.jsx)(n.A,{className:"ml-auto transition-transform group-data-[state=open]/collapsible:rotate-90"})]})}),(0,a.jsx)(c.Ke,{children:(0,a.jsx)(d.rQ,{children:(0,a.jsx)(d.wZ,{children:e.items.map(e=>(0,a.jsx)(d.FX,{children:(0,a.jsx)(d.Uj,{asChild:!0,children:(0,a.jsx)(r(),{href:e.url,children:e.title})})},e.title))})})})]})},e.title))}),(0,a.jsx)(d.CG,{className:"p-4",children:(0,a.jsx)(l.r,{})}),(0,a.jsx)(d.jM,{})]})}},49274:(e,t,s)=>{Promise.resolve().then(s.bind(s,18655))},95784:(e,t,s)=>{"use strict";s.d(t,{TR:()=>f,bq:()=>m,eb:()=>h,gC:()=>x,l6:()=>d,s3:()=>o,yv:()=>u});var a=s(95155);s(12115);var n=s(93081),l=s(66474),i=s(5196),r=s(47863),c=s(53999);function d(e){let{...t}=e;return(0,a.jsx)(n.bL,{"data-slot":"select",...t})}function o(e){let{...t}=e;return(0,a.jsx)(n.YJ,{"data-slot":"select-group",...t})}function u(e){let{...t}=e;return(0,a.jsx)(n.WT,{"data-slot":"select-value",...t})}function m(e){let{className:t,children:s,...i}=e;return(0,a.jsxs)(n.l9,{"data-slot":"select-trigger",className:(0,c.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[s,(0,a.jsx)(n.In,{asChild:!0,children:(0,a.jsx)(l.A,{className:"size-4 opacity-50"})})]})}function x(e){let{className:t,children:s,position:l="popper",...i}=e;return(0,a.jsx)(n.ZL,{children:(0,a.jsxs)(n.UC,{"data-slot":"select-content",className:(0,c.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...i,children:[(0,a.jsx)(g,{}),(0,a.jsx)(n.LM,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(p,{})]})})}function f(e){let{className:t,...s}=e;return(0,a.jsx)(n.JU,{"data-slot":"select-label",className:(0,c.cn)("px-2 py-1.5 text-sm font-medium",t),...s})}function h(e){let{className:t,children:s,...l}=e;return(0,a.jsxs)(n.q7,{"data-slot":"select-item",className:(0,c.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...l,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(n.VF,{children:(0,a.jsx)(i.A,{className:"size-4"})})}),(0,a.jsx)(n.p4,{children:s})]})}function g(e){let{className:t,...s}=e;return(0,a.jsx)(n.PP,{"data-slot":"select-scroll-up-button",className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(r.A,{className:"size-4"})})}function p(e){let{className:t,...s}=e;return(0,a.jsx)(n.wn,{"data-slot":"select-scroll-down-button",className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(l.A,{className:"size-4"})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[507,888,655,2,745,528,441,684,358],()=>t(49274)),_N_E=e.O()}]);