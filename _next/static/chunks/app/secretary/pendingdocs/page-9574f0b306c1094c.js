(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[372],{40243:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var s=a(95155),r=a(12115),n=a(34293),l=a(81115),i=a(40879),o=a(71919),c=a(76037),d=a(84995),u=a(88524),m=a(89852),h=a(97168),x=a(95784),f=a(36639);function j(){let[e,t]=(0,r.useState)(""),[a,j]=(0,r.useState)([]),[b,p]=(0,r.useState)(null),[g,w]=(0,r.useState)(""),[v,N]=(0,r.useState)(""),[y,D]=(0,r.useState)(""),[O,k]=(0,r.useState)(new Set),[A,R]=(0,r.useState)(!1),[C,S]=(0,r.useState)(""),[T,I]=(0,r.useState)(""),[E,F]=(0,r.useState)("operator");(0,r.useEffect)(()=>{let e=(0,l.KR)(n.OO,"documents"),t=(0,l.Zy)(e,e=>{try{if(e.exists()){let t=[],a=new Set;e.forEach(e=>{let s=e.val();if("Secretary"===s.forwardedTo&&"Open"===s.status){let r={id:e.key,awdReceivedDate:s.awdReceivedDate||"",awdReferenceNumber:s.awdReferenceNumber||"",subject:s.subject||"",dateOfDocument:s.dateOfDocument||"",deadline:s.deadline||"",startDate:s.startDate||s.awdReceivedDate||new Date().toISOString(),fsisReferenceNumber:s.fsisReferenceNumber||"",originatingOffice:s.originatingOffice||"",forwardedBy:s.forwardedBy||"",forwardedTo:s.forwardedTo||"",remarks:s.remarks||"",status:s.status||"Open",workingDays:s.workingDays||"",dateTimeSubmitted:s.dateTimeSubmitted||new Date().toISOString(),assignedInspector:s.assignedInspector||""};t.push(r);let n=localStorage.getItem("lastVisit");if(n&&r.dateTimeSubmitted){let t=new Date(r.dateTimeSubmitted),s=new Date(n);t>s&&a.add(e.key)}}}),k(a),j(t)}else j([])}catch(e){console.error("Error loading documents:",e)}});return localStorage.setItem("lastVisit",new Date().toISOString()),()=>t()},[]);let _=()=>new Date().toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(",",""),U=async()=>{if(b&&g)try{var e,t,a,s;let r=localStorage.getItem("authToken");if(!r)throw Error("User not authenticated");let i=(0,l.KR)(n.OO,"accounts/".concat(r)),o=await new Promise(e=>{(0,l.Zy)(i,t=>{e(t)},{onlyOnce:!0})});if(!o.exists())throw Error("User not found");let c=o.val(),d="".concat(c.name," (").concat(c.division,")"),u=_(),m=(0,l.KR)(n.OO,"documents/".concat(null!==(e=null==b?void 0:b.id)&&void 0!==e?e:""));await (0,l.yo)(m,{forwardedBy:d,forwardedTo:g,remarks:y||"FAA",status:"Open",dateTimeSubmitted:u});let h=(0,l.KR)(n.OO,"tracking");await (0,l.VC)(h,{action:"Forwarded",forwardedBy:d,forwardedTo:g,remarks:y||"FAA",status:"Open",dateTimeSubmitted:u,actionTimestamp:Date.now(),awdReferenceNumber:null!==(t=null==b?void 0:b.awdReferenceNumber)&&void 0!==t?t:"",subject:null!==(a=null==b?void 0:b.subject)&&void 0!==a?a:"",originatingOffice:null!==(s=null==b?void 0:b.originatingOffice)&&void 0!==s?s:"",forwardedtoname:null!=v?v:""}),p(null),w(""),N(""),D(""),alert("Document forwarded successfully!")}catch(e){console.error("Error forwarding document:",e),alert("Failed to forward document")}},z=async()=>{if(b&&C.trim())try{let e=localStorage.getItem("authToken");if(!e)throw Error("User not authenticated");let t=(0,l.KR)(n.OO,"accounts/".concat(e)),a=await new Promise(e=>{(0,l.Zy)(t,t=>{e(t)},{onlyOnce:!0})});if(!a.exists())throw Error("User not found");let s=a.val(),r="".concat(s.name," (").concat(s.division,")"),i=_(),o=(0,l.KR)(n.OO,"documents/".concat(b.id));await (0,l.yo)(o,{forwardedBy:r,forwardedTo:"Admin",remarks:C,status:"Open",dateTimeSubmitted:i});let c=(0,l.KR)(n.OO,"tracking");await (0,l.VC)(c,{action:"Returned to Operator",forwardedBy:r,forwardedTo:"Admin",remarks:C,status:"Open",dateTimeSubmitted:i,actionTimestamp:Date.now(),awdReferenceNumber:b.awdReferenceNumber,subject:b.subject,originatingOffice:b.originatingOffice}),p(null),S(""),R(!1),alert("Document returned to Operator successfully!")}catch(e){console.error("Error returning document:",e),alert("Failed to return document")}},B=async()=>{if(b&&T&&C.trim())try{let e=localStorage.getItem("authToken");if(!e)throw Error("User not authenticated");let t=(0,l.KR)(n.OO,"accounts/".concat(e)),a=await new Promise(e=>{(0,l.Zy)(t,t=>{e(t)},{onlyOnce:!0})});if(!a.exists())throw Error("User not found");let s=a.val(),r="".concat(s.name," (").concat(s.division,")"),i=_(),o=(0,l.KR)(n.OO,"documents/".concat(b.id));await (0,l.yo)(o,{forwardedBy:r,forwardedTo:T,remarks:C,status:"Open",dateTimeSubmitted:i});let c=(0,l.KR)(n.OO,"tracking");await (0,l.VC)(c,{action:"Forwarded to Inspector",forwardedBy:r,forwardedTo:T,remarks:C,status:"Open",dateTimeSubmitted:i,actionTimestamp:Date.now(),awdReferenceNumber:b.awdReferenceNumber,subject:b.subject,originatingOffice:b.originatingOffice}),p(null),S(""),I(""),R(!1),alert("Document forwarded to ".concat(T," successfully!"))}catch(e){console.error("Error forwarding to inspector:",e),alert("Failed to forward document")}},K=a.filter(t=>{let a=e.toLowerCase();return t.subject.toLowerCase().includes(a)||t.awdReferenceNumber.toLowerCase().includes(a)||t.forwardedBy.toLowerCase().includes(a)||t.remarks.toLowerCase().includes(a)}),L=e=>{if(p(e),e.id&&O.has(e.id)){let t=new Set(O);t.delete(e.id),k(t)}};return(0,s.jsx)(f.A,{allowedDivisions:["secretary"],children:(0,s.jsx)(o.GB,{children:(0,s.jsxs)("div",{className:"flex h-screen",children:[(0,s.jsx)(i.Y,{}),(0,s.jsxs)(o.sF,{className:"flex flex-1 flex-col",children:[(0,s.jsxs)("header",{className:"flex h-16 items-center gap-2 border-b px-4 bg-white",children:[(0,s.jsx)(o.x2,{className:"-ml-1"}),(0,s.jsx)(c.w,{orientation:"vertical",className:"mr-2 h-4"}),(0,s.jsx)(d.Qp,{children:(0,s.jsxs)(d.AB,{children:[(0,s.jsx)(d.J5,{className:"hidden md:block",children:(0,s.jsx)(d.tJ,{children:"Documents"})}),(0,s.jsx)(d.tH,{className:"hidden md:block"}),(0,s.jsx)(d.J5,{children:(0,s.jsx)(d.tJ,{children:"Pending Documents"})})]})})]}),(0,s.jsxs)("div",{className:"p-6 max-w-5xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold",children:"Pending Documents"}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)(m.p,{type:"text",placeholder:"Search documents...",value:e,onChange:e=>t(e.target.value),className:"w-64"})})]}),(0,s.jsxs)("p",{className:"mb-4 text-gray-600",children:["Showing ",K.length," of ",a.length," documents"]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(u.XI,{className:"border w-full",children:[(0,s.jsx)(u.A0,{children:(0,s.jsxs)(u.Hj,{className:"bg-gray-100",children:[(0,s.jsx)(u.nd,{className:"w-1/6",children:"Date"}),(0,s.jsx)(u.nd,{className:"w-1/6",children:"AWD No."}),(0,s.jsx)(u.nd,{className:"w-2/6",children:"Subject"}),(0,s.jsx)(u.nd,{className:"w-1/6",children:"Forwarded By"}),(0,s.jsx)(u.nd,{className:"w-1/6",children:"Forwarded To"}),(0,s.jsx)(u.nd,{className:"w-1/6",children:"Remarks"})]})}),(0,s.jsx)(u.BF,{children:K.map(e=>{var t,a;return(0,s.jsxs)(u.Hj,{onClick:()=>L(e),className:"cursor-pointer hover:bg-gray-50",children:[(0,s.jsxs)(u.nA,{className:"relative",children:[O.has(null!==(t=e.id)&&void 0!==t?t:"")&&(0,s.jsx)("span",{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-blue-500 rounded-full"}),e.awdReceivedDate]}),(0,s.jsx)(u.nA,{children:e.awdReferenceNumber}),(0,s.jsx)(u.nA,{className:"truncate",children:e.subject}),(0,s.jsx)(u.nA,{children:e.forwardedBy}),(0,s.jsx)(u.nA,{children:e.forwardedTo}),(0,s.jsx)(u.nA,{children:e.remarks})]},null!==(a=e.id)&&void 0!==a?a:"")})})]})}),b&&(0,s.jsxs)("div",{className:"mt-6 p-6 border rounded-lg shadow-lg bg-white max-w-2xl mx-auto",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Document Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-3 mb-6",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Subject:"})," ",b.subject]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"AWD No.:"})," ",b.awdReferenceNumber]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Date Received:"})," ",b.awdReceivedDate]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Forwarded By:"})," ",b.forwardedBy]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Remarks:"})," ",b.remarks]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Working Days:"})," ",((e,t)=>{if(!e||!t)return 0;let a=new Date(e),s=new Date(t);if(s<new Date)return -1;let r=0,n=new Date(a);for(;n<=s;){let e=n.getDay();0!==e&&6!==e&&r++,n.setDate(n.getDate()+1)}return r})(b.startDate,b.deadline)," days remaining"]})]}),A?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block font-semibold mb-2",children:"Return Remarks:"}),(0,s.jsx)("textarea",{value:C,onChange:e=>S(e.target.value),className:"w-full p-2 border rounded min-h-[100px]",placeholder:"Enter return remarks"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block font-semibold mb-2",children:"Return Action:"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(h.$,{variant:"operator"===E?"default":"outline",onClick:()=>F("operator"),children:"Return to Operator"}),(0,s.jsx)(h.$,{variant:"inspector"===E?"default":"outline",onClick:()=>F("inspector"),children:"Forward to Inspector"})]})]}),"inspector"===E&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block font-semibold mb-2",children:"Select Division:"}),(0,s.jsxs)(x.l6,{onValueChange:I,children:[(0,s.jsx)(x.bq,{children:(0,s.jsx)(x.yv,{placeholder:"Select division"})}),(0,s.jsxs)(x.gC,{children:[(0,s.jsx)(x.eb,{value:"CATCID Admin",children:"CATCID"}),(0,s.jsx)(x.eb,{value:"GACID Admin",children:"GACID"}),(0,s.jsx)(x.eb,{value:"EARD Admin",children:"EARD"}),(0,s.jsx)(x.eb,{value:"MOCSU Admin",children:"MOCSU"})]})]})]}),(0,s.jsx)(h.$,{className:"w-full",onClick:"operator"===E?z:B,disabled:!C.trim()||"inspector"===E&&!T,children:"operator"===E?"Return to Operator (Admin)":"Forward to ".concat(T||"Inspector")}),(0,s.jsx)(h.$,{className:"w-full mt-2",variant:"default",onClick:()=>R(!1),children:"Cancel Return"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block font-semibold mb-2",children:"Forward To:"}),(0,s.jsxs)("select",{value:g,onChange:e=>w(e.target.value),className:"w-full p-2 border rounded",children:[(0,s.jsx)("option",{value:"",children:"Select destination"}),(0,s.jsx)("option",{value:"CATCID Admin",children:"CATCID Admin"}),(0,s.jsx)("option",{value:"GACID Admin",children:"GACID Admin"}),(0,s.jsx)("option",{value:"EARD Admin",children:"EARD Admin"}),(0,s.jsx)("option",{value:"MOCSU Admin",children:"MOCSU Admin"}),(0,s.jsx)("option",{value:"Admin",children:"Admin"})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block font-semibold mb-2",children:"Forward To Name:"}),(0,s.jsx)(m.p,{type:"text",value:v,onChange:e=>N(e.target.value),placeholder:"Recipient name"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block font-semibold mb-2",children:"Remarks:"}),(0,s.jsx)("textarea",{value:y,onChange:e=>D(e.target.value),className:"w-full p-2 border rounded min-h-[100px]",placeholder:"Enter remarks"})]}),(0,s.jsx)(h.$,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:U,disabled:!g,children:"Forward Document"}),(0,s.jsx)(h.$,{className:"w-full mt-2 ",variant:A?"default":"outline",onClick:()=>R(!A),children:A?"Cancel Return":"Return Document"})]})]})]})]})]})})})}},40879:(e,t,a)=>{"use strict";a.d(t,{Y:()=>m});var s=a(95155);a(12115);var r=a(13052),n=a(50095),l=a(6874),i=a.n(l),o=a(66766),c=a(65204),d=a(71919);let u={navMain:[{title:"Home",items:[{title:"Dashboard",url:"/secretary/dashboard"},{title:"Division",url:"/secretary/division"},{title:"Hold Documents",url:"/secretary/holddocuments"}]},{title:"Documents",items:[{title:"Ongoing Documents",url:"/secretary/ongoingdocs"},{title:"Pending Documents",url:"/secretary/pendingdocs"},{title:"Sent Documents",url:"/secretary/sentdocs"}]}]};function m(e){let{...t}=e;return(0,s.jsxs)(d.Bx,{...t,children:[(0,s.jsxs)(d.Gh,{className:"flex items-center pt-2 font-bold justify-center text-2xl gap-2",children:[(0,s.jsx)(o.default,{src:"/images/awdlogo.png",alt:"Airworthiness Logo",width:80,height:80,className:"w-20 h-20"}),"AIRWORTHINESS"]}),(0,s.jsx)(d.Yv,{className:"gap-0",children:u.navMain.map(e=>(0,s.jsx)(c.Nt,{title:e.title,defaultOpen:!0,className:"group/collapsible",children:(0,s.jsxs)(d.Cn,{children:[(0,s.jsx)(d.jj,{asChild:!0,className:"group/label text-sm text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",children:(0,s.jsxs)(c.R6,{children:[e.title," ",(0,s.jsx)(r.A,{className:"ml-auto transition-transform group-data-[state=open]/collapsible:rotate-90"})]})}),(0,s.jsx)(c.Ke,{children:(0,s.jsx)(d.rQ,{children:(0,s.jsx)(d.wZ,{children:e.items.map(e=>(0,s.jsx)(d.FX,{children:(0,s.jsx)(d.Uj,{asChild:!0,children:(0,s.jsx)(i(),{href:e.url,children:e.title})})},e.title))})})})]})},e.title))}),(0,s.jsx)(d.CG,{className:"p-4",children:(0,s.jsx)(n.r,{})}),(0,s.jsx)(d.jM,{})]})}},88524:(e,t,a)=>{"use strict";a.d(t,{A0:()=>l,BF:()=>i,Hj:()=>o,XI:()=>n,nA:()=>d,nd:()=>c});var s=a(95155);a(12115);var r=a(53999);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,r.cn)("w-full caption-bottom text-sm",t),...a})})}function l(e){let{className:t,...a}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,r.cn)("[&_tr]:border-b",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,r.cn)("[&_tr:last-child]:border-0",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,r.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,r.cn)("text-muted-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,r.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}},95784:(e,t,a)=>{"use strict";a.d(t,{TR:()=>x,bq:()=>m,eb:()=>f,gC:()=>h,l6:()=>c,s3:()=>d,yv:()=>u});var s=a(95155);a(12115);var r=a(93081),n=a(66474),l=a(5196),i=a(47863),o=a(53999);function c(e){let{...t}=e;return(0,s.jsx)(r.bL,{"data-slot":"select",...t})}function d(e){let{...t}=e;return(0,s.jsx)(r.YJ,{"data-slot":"select-group",...t})}function u(e){let{...t}=e;return(0,s.jsx)(r.WT,{"data-slot":"select-value",...t})}function m(e){let{className:t,children:a,...l}=e;return(0,s.jsxs)(r.l9,{"data-slot":"select-trigger",className:(0,o.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l,children:[a,(0,s.jsx)(r.In,{asChild:!0,children:(0,s.jsx)(n.A,{className:"size-4 opacity-50"})})]})}function h(e){let{className:t,children:a,position:n="popper",...l}=e;return(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{"data-slot":"select-content",className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...l,children:[(0,s.jsx)(j,{}),(0,s.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(b,{})]})})}function x(e){let{className:t,...a}=e;return(0,s.jsx)(r.JU,{"data-slot":"select-label",className:(0,o.cn)("px-2 py-1.5 text-sm font-medium",t),...a})}function f(e){let{className:t,children:a,...n}=e;return(0,s.jsxs)(r.q7,{"data-slot":"select-item",className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...n,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(r.VF,{children:(0,s.jsx)(l.A,{className:"size-4"})})}),(0,s.jsx)(r.p4,{children:a})]})}function j(e){let{className:t,...a}=e;return(0,s.jsx)(r.PP,{"data-slot":"select-scroll-up-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(i.A,{className:"size-4"})})}function b(e){let{className:t,...a}=e;return(0,s.jsx)(r.wn,{"data-slot":"select-scroll-down-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(n.A,{className:"size-4"})})}},99847:(e,t,a)=>{Promise.resolve().then(a.bind(a,40243))}},e=>{var t=t=>e(e.s=t);e.O(0,[507,888,655,2,745,528,441,684,358],()=>t(99847)),_N_E=e.O()}]);